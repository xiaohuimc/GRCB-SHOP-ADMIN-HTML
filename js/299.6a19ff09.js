"use strict";(self["webpackChunkadmin"]=self["webpackChunkadmin"]||[]).push([[299],{72299:function(e,t,a){a.r(t),a.d(t,{default:function(){return u}});var r=function(){var e=this,t=e._self._c;return t("div",{staticClass:"content-page"},[t("div",{staticClass:"content-nav"},[t("el-breadcrumb",{staticClass:"breadcrumb",attrs:{separator:"/"}},[t("el-breadcrumb-item",{attrs:{to:{name:"freight"}}},[e._v("运费模板")]),t("el-breadcrumb-item",[e._v(e._s(e.infoForm.id?"编辑模板":"添加模板"))])],1),t("div",{staticClass:"operation-nav"},[t("el-button",{attrs:{type:"primary",icon:"arrow-left"},on:{click:e.goBackPage}},[e._v("返回列表")])],1)],1),t("div",{staticClass:"content-main"},[t("div",{staticClass:"form-table-box"},[t("el-form",{ref:"infoForm",attrs:{rules:e.infoRules,model:e.infoForm,"label-width":"120px"}},[t("el-form-item",{attrs:{label:"模板名字",prop:"name"}},[t("el-input",{attrs:{placeholder:"请输入模板名称",autofocus:""},model:{value:e.infoForm.name,callback:function(t){e.$set(e.infoForm,"name",t)},expression:"infoForm.name"}})],1),t("el-form-item",{attrs:{label:"包装费用"}},[t("el-input",{model:{value:e.infoForm.package_price,callback:function(t){e.$set(e.infoForm,"package_price",t)},expression:"infoForm.package_price"}})],1),t("el-form-item",{attrs:{label:"快递收费方式"}},[t("el-radio-group",{model:{value:e.infoForm.freight_type,callback:function(t){e.$set(e.infoForm,"freight_type",t)},expression:"infoForm.freight_type"}},[t("el-radio",{attrs:{label:0}},[e._v("按件计费")]),t("el-radio",{attrs:{label:1}},[e._v("按重量计费")])],1)],1),t("el-form-item",{staticClass:"default-freight",attrs:{label:"默认运费"}},[t("div",{staticClass:"form-table-box"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.defaultData,border:"",stripe:""}},[t("el-table-column",{attrs:{prop:"start",label:0==e.infoForm.freight_type?"首件(个)":"首重(KG)"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{size:"mini",placeholder:"个",autofocus:""},on:{blur:function(t){return e.submitValue(a.$index,a.row.start)}},model:{value:a.row.start,callback:function(t){e.$set(a.row,"start",t)},expression:"scope.row.start"}})]}}])}),t("el-table-column",{attrs:{prop:"start_fee",label:"运费(元)"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{size:"mini",placeholder:"运费"},on:{blur:function(t){return e.submitValue(a.$index,a.row.start_fee)}},model:{value:a.row.start_fee,callback:function(t){e.$set(a.row,"start_fee",t)},expression:"scope.row.start_fee"}})]}}])}),t("el-table-column",{attrs:{prop:"add",label:0==e.infoForm.freight_type?"续件(个)":"续重(KG)"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{size:"mini",placeholder:"个"},on:{blur:function(t){return e.submitValue(a.$index,a.row.add)}},model:{value:a.row.add,callback:function(t){e.$set(a.row,"add",t)},expression:"scope.row.add"}})]}}])}),t("el-table-column",{attrs:{prop:"add_fee",label:"运费(元)"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{size:"mini",placeholder:"运费"},on:{blur:function(t){return e.submitValue(a.$index,a.row.add_fee)}},model:{value:a.row.add_fee,callback:function(t){e.$set(a.row,"add_fee",t)},expression:"scope.row.add_fee"}})]}}])}),t("el-table-column",{attrs:{prop:"free_by_number",label:"按件包邮",width:"140"},scopedSlots:e._u([{key:"default",fn:function(a){return[0==a.row.free_by_number?t("el-switch",{attrs:{"active-color":"#13ce66"},on:{change:function(t){return e.changeDefaultNumberSwitch(a.$index,a.row)}},model:{value:a.row.freeByNumber,callback:function(t){e.$set(a.row,"freeByNumber",t)},expression:"scope.row.freeByNumber"}}):e._e(),a.row.free_by_number>0?t("el-input-number",{staticClass:"number_input",attrs:{min:0,max:99999,"controls-position":"right",size:"mini",placeholder:"件"},on:{blur:function(t){return e.changeDefaultNumberInput(a.$index,a.row.free_by_number)},change:function(t){return e.changeDefaultNumberInput(a.$index,a.row.free_by_number)}},model:{value:a.row.free_by_number,callback:function(t){e.$set(a.row,"free_by_number",t)},expression:"scope.row.free_by_number"}}):e._e()]}}])}),t("el-table-column",{attrs:{prop:"free_by_money",label:"按金额包邮",width:"140"},scopedSlots:e._u([{key:"default",fn:function(a){return[0==a.row.free_by_money?t("el-switch",{attrs:{"active-color":"#13ce66"},on:{change:function(t){return e.changeDefaultMoneySwitch(a.$index,a.row)}},model:{value:a.row.freeByMoney,callback:function(t){e.$set(a.row,"freeByMoney",t)},expression:"scope.row.freeByMoney"}}):e._e(),a.row.free_by_money>0?t("el-input-number",{staticClass:"money_input",attrs:{min:0,max:99999,"controls-position":"right",size:"mini",placeholder:"金额"},on:{blur:function(t){return e.changeDefaultMoneyInput(a.$index,a.row.free_by_money)},change:function(t){return e.changeDefaultMoneyInput(a.$index,a.row.free_by_money)}},model:{value:a.row.free_by_money,callback:function(t){e.$set(a.row,"free_by_money",t)},expression:"scope.row.free_by_money"}}):e._e()]}}])})],1)],1)]),t("el-form-item",{staticClass:"special-freight",attrs:{label:"指定区域运费"}},[t("div",{staticClass:"form-table-box"},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",stripe:""}},[t("el-table-column",{attrs:{prop:"areaName",label:"运送到"}}),t("el-table-column",{attrs:{prop:"start",label:0==e.infoForm.freight_type?"首件(个)":"首重(KG)",width:"90"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{size:"mini",placeholder:"个",autofocus:""},on:{blur:function(t){return e.submitValue(a.$index,a.row.start)}},model:{value:a.row.start,callback:function(t){e.$set(a.row,"start",t)},expression:"scope.row.start"}})]}}])}),t("el-table-column",{attrs:{prop:"start_fee",label:"运费(元)",width:"90"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{size:"mini",placeholder:"运费"},on:{blur:function(t){return e.submitValue(a.$index,a.row.start_fee)}},model:{value:a.row.start_fee,callback:function(t){e.$set(a.row,"start_fee",t)},expression:"scope.row.start_fee"}})]}}])}),t("el-table-column",{attrs:{prop:"add",label:0==e.infoForm.freight_type?"续件(个)":"续重(KG)",width:"90"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{size:"mini",placeholder:"个"},on:{blur:function(t){return e.submitValue(a.$index,a.row.add)}},model:{value:a.row.add,callback:function(t){e.$set(a.row,"add",t)},expression:"scope.row.add"}})]}}])}),t("el-table-column",{attrs:{prop:"add_fee",label:"运费(元)",width:"90"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-input",{attrs:{size:"mini",placeholder:"运费"},on:{blur:function(t){return e.submitValue(a.$index,a.row.add_fee)}},model:{value:a.row.add_fee,callback:function(t){e.$set(a.row,"add_fee",t)},expression:"scope.row.add_fee"}})]}}])}),t("el-table-column",{attrs:{prop:"free_by_number",label:"按件包邮",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[0==a.row.free_by_number?t("el-switch",{attrs:{"active-color":"#13ce66"},on:{change:function(t){return e.changeNumberSwitch(a.$index,a.row)}},model:{value:a.row.freeByNumber,callback:function(t){e.$set(a.row,"freeByNumber",t)},expression:"scope.row.freeByNumber"}}):e._e(),a.row.free_by_number>0?t("el-input-number",{staticClass:"number_input",attrs:{min:0,max:99999,"controls-position":"right",size:"mini",placeholder:"件"},on:{blur:function(t){return e.changeNumberInput(a.$index,a.row.free_by_number)},change:function(t){return e.changeNumberInput(a.$index,a.row.free_by_number)}},model:{value:a.row.free_by_number,callback:function(t){e.$set(a.row,"free_by_number",t)},expression:"scope.row.free_by_number"}}):e._e()]}}])}),t("el-table-column",{attrs:{prop:"free_by_money",label:"按金额包邮",width:"120"},scopedSlots:e._u([{key:"default",fn:function(a){return[0==a.row.free_by_money?t("el-switch",{attrs:{"active-color":"#13ce66"},on:{change:function(t){return e.changeMoneySwitch(a.$index,a.row)}},model:{value:a.row.freeByMoney,callback:function(t){e.$set(a.row,"freeByMoney",t)},expression:"scope.row.freeByMoney"}}):e._e(),a.row.free_by_money>0?t("el-input-number",{staticClass:"money_input",attrs:{min:0,max:99999,"controls-position":"right",size:"mini",placeholder:"金额"},on:{blur:function(t){return e.changeMoneyInput(a.$index,a.row.free_by_money)},change:function(t){return e.changeMoneyInput(a.$index,a.row.free_by_money)}},model:{value:a.row.free_by_money,callback:function(t){e.$set(a.row,"free_by_money",t)},expression:"scope.row.free_by_money"}}):e._e()]}}])}),t("el-table-column",{attrs:{label:"操作",width:"160"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini",type:"primary",plain:""},on:{click:function(t){return e.handleRowEdit(a.$index,a.row)}}},[e._v("编辑地区 ")]),t("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(t){return t.preventDefault(),e.deleteRow(a.$index,e.tableData)}}},[e._v(" 移除 ")])]}}])})],1)],1),t("div",{staticClass:"add-btn"},[t("el-button",{attrs:{type:"text"},on:{click:e.add_template}},[e._v("+添加指定地区运费")]),t("el-form-item",[e.infoForm.id?t("el-button",{staticClass:"float-right",attrs:{type:"danger"},on:{click:e.onSaveTemplate}},[e._v(" 保存模板 ")]):t("el-button",{staticClass:"float-right",attrs:{type:"danger"},on:{click:e.onAddTemplate}},[e._v("保存模板2 ")])],1)],1)])],1)],1)]),t("el-dialog",{attrs:{size:"tiny",title:"设置运送到到区域",visible:e.specEditVisible},on:{"update:visible":function(t){e.specEditVisible=t}}},[t("el-form",{ref:"specForm",staticClass:"specFormDialig"},[t("el-form-item",{attrs:{label:"",prop:"value","label-width":"100px"}},[t("el-transfer",{attrs:{props:{key:"id",label:"name"},data:e.areaData,titles:["可选","已选"]},model:{value:e.selectedArea,callback:function(t){e.selectedArea=t},expression:"selectedArea"}})],1)],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){e.specEditVisible=!1}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:e.updateArea}},[e._v("确定")])],1)],1)],1)},o=[],n=(a(57658),a(70636),{data(){return{value:!0,nowTableIndex:0,areaData:[],selectedArea:[],hiddenSelectedArea:[],specEditVisible:!1,infoForm:{id:0,freight_type:0,package_price:0,name:""},infoRules:{name:[{required:!0,message:"请输入模板名称",trigger:"blur"}]},tableData:[],defaultData:[{start:1,start_fee:0,add:1,add_fee:0,freeByMoney:!1,freeByNumber:!1,free_by_money:0,free_by_number:0}]}},methods:{changeDefaultNumberSwitch(e,t){1==t.freeByNumber&&(this.defaultData[e].free_by_number=1)},changeDefaultMoneySwitch(e,t){1==t.freeByMoney&&(this.defaultData[e].free_by_money=1)},changeDefaultNumberInput(e,t){0==t&&(this.defaultData[e].freeByNumber=!1)},changeDefaultMoneyInput(e,t){0==t&&(this.defaultData[e].freeByMoney=!1)},changeNumberSwitch(e,t){1==t.freeByNumber&&(this.tableData[e].free_by_number=1)},changeMoneySwitch(e,t){1==t.freeByMoney&&(this.tableData[e].free_by_money=1)},changeNumberInput(e,t){0==t&&(this.tableData[e].freeByNumber=!1)},changeMoneyInput(e,t){0==t&&(this.tableData[e].freeByMoney=!1)},submitValue(e,t){if(""==t||t<0)return this.$message({type:"error",message:"值不能为空或小于零"}),!1},updateArea(){let e=this.nowTableIndex,t=this.areaData,a=this.selectedArea;a=a.join(","),this.tableData[e].area=a;let r=this.selectedArea,o=[];for(const s in r)t.map((e=>e.id==r[s]?o.push(e.name):""));let n=this;n.tableData[e].areaName=o.join(","),n.tableData[e].start=1,n.tableData[e].add=1,console.log("--------"),console.log(n.tableData[e].area),console.log("--------"),n.specEditVisible=!1},onSaveTemplate(){let e=this.infoForm.name,t=this.defaultData;if(""==e)return this.$message({type:"error",message:"名称不能为空"}),!1;for(const o of t){if(0==o.start||0==o.add||o.start_fee<0||o.add_fee<0)return this.$message({type:"error",message:"值不能为空"}),!1;if(""==o.area)return this.$message({type:"error",message:"地区不能为空"}),!1}let a=this.tableData;for(const o of a){if(0==o.start||0==o.add||o.start_fee<0||o.add_fee<0)return this.$message({type:"error",message:"值不能为空"}),!1;if(""==o.area)return this.$message({type:"error",message:"地区不能为空"}),!1}let r=this;this.axios.post("shipper/saveTable",{table:r.tableData,defaultData:r.defaultData,info:r.infoForm}).then((e=>{0===e.data.errno?(this.$message({type:"success",message:"保存成功"}),r.getInfo()):this.$message({type:"error",message:"保存失败"})}))},onAddTemplate(){let e=this.infoForm.name,t=(this.infoForm.freight_type,this.defaultData);if(""==e)return this.$message({type:"error",message:"名称不能为空"}),!1;for(const o of t){if(0==o.start||0==o.add||o.start_fee<0||o.add_fee<0)return this.$message({type:"error",message:"值不能为空"}),!1;if(""==o.area)return this.$message({type:"error",message:"地区不能为空"}),!1}let a=this.tableData;for(const o of a){if(0==o.start||0==o.add||o.start_fee<0||o.add_fee<0)return this.$message({type:"error",message:"值不能为空"}),!1;if(""==o.area)return this.$message({type:"error",message:"地区不能为空"}),!1}let r=this;this.axios.post("shipper/addTable",{table:r.tableData,defaultData:r.defaultData,info:r.infoForm}).then((e=>{0===e.data.errno?(r.$message({type:"success",message:"添加成功"}),r.$router.go(-1)):r.$message({type:"error",message:"添加失败"})}))},deleteRow(e,t){this.$confirm("确定要删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{t.splice(e,1)}))},test(){console.log(this.tableData[0])},add_template(){let e={template_id:"",area:"",start:"",start_fee:"",add:"",add_fee:"",free_by_money:!1,free_by_number:!1};this.tableData.push(e)},goBackPage(){this.$router.go(-1)},getAllAreaData(){let e=this;this.axios.post("shipper/getareadata").then((t=>{0===t.data.errno&&(e.areaData=t.data.data)}))},handleRowEdit(e,t){this.nowTableIndex=e;let a=this.tableData[e].area;this.selectedArea=a.split(",").map(Number);let r=this.tableData,o="";for(const s in r)s!=e&&(o=r[s].area+","+o);o=o.split(",");let n=this.areaData;for(const s of n){s.disabled=!1;for(const e of o)s.id==e&&(s.disabled=!0)}this.specEditVisible=!0},getAreaData(){let e=this;this.axios.post("shipper/freightdetail",{id:e.infoForm.id}).then((t=>{e.infoForm=t.data.data.freight,e.tableData=t.data.data.data}))},getInfo(){if(this.infoForm.id<=0)return!1;let e=this;this.axios.post("shipper/freightdetail",{id:e.infoForm.id}).then((t=>{e.infoForm=t.data.data.freight,e.tableData=t.data.data.data,e.defaultData=t.data.data.defaultData,console.log(e.defaultData)}))}},components:{},mounted(){this.infoForm.id=this.$route.query.id||0,this.getInfo(),this.getAllAreaData()}}),s=n,l=a(1001),i=(0,l.Z)(s,r,o,!1,null,"8551872e",null),u=i.exports}}]);
//# sourceMappingURL=299.6a19ff09.js.map